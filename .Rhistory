plot = p,
width = file_width,
height = file_height,
limitsize = FALSE)
# -----------------------------
# Build the final trees
# -----------------------------
# The rectangular layout tree.
p <- ggtree(tree,
size=0.15
) +
xlim(-0.1,NA) +
ylim(-0.1,NA) +
geom_nodelab(size = 2, nudge_x = 0.01, nudge_y = 0.5) +
geom_highlight(data = highlight_nodes,aes(node=node),extendto = 11.5)
p <- p %<+% protein_metadata +
geom_tippoint(
aes(color = phylum),
size = 0.4,
show.legend = TRUE
) +
geom_tiplab(
aes(color = phylum,
size = font_size,
fontface = font_style),
align=TRUE,
linetype=3,
#size = 3,
hjust = -0.1,
linesize= 0.2,
show.legend=FALSE,
offset = 0.05
) +
scale_size_identity(guide = "none") +
scale_color_manual(
name = "Phylum",
values = phylum_palette,
na.translate = FALSE
)
p <- p +
geom_cladelab(
data = set_clades,
mapping = aes(
node = node,
label = name
# offset.text = offset.text,
),
align = FALSE,
offset = 7,
#offset.text = 0.24,
hjust = "left",
barsize = 1,
fontsize = 3,
#angle = "auto",
horizontal = FALSE
)
p <- p +
geom_fruit(
data=lifestyle_metadata,
geom=geom_tile,
mapping=aes(
y=protein_id,
x=lifestyle,
alpha=binary,
fill = lifestyle_set,),
offset = 0.34,
# width = 0.1,
# height = 1,
axis.params = list(
axis = "x",  # Display the x-axis
text.size = 3, # Adjust tick label size
text.angle = 30, # Rotate tick labels for better readability
line.size = 0,
hjust = "right"
)
) +
scale_fill_manual(
name = "Lifestyle",
values = unique(unname(lifestyle_palette))
) +
geom_treescale(fontsize=3, linesize=1, x=0.1, y=-0.05)
file_height <- 40
file_width <- 30
ggsave(output_tree_rect,
plot = p,
width = file_width,
height = file_height,
limitsize = FALSE)
# -----------------------------
# Build the final trees
# -----------------------------
# The rectangular layout tree.
p <- ggtree(tree,
size=0.15
) +
xlim(-0.1,NA) +
ylim(-0.1,NA) +
geom_nodelab(size = 2, nudge_x = 0.01, nudge_y = 0.5) +
geom_highlight(data = highlight_nodes,aes(node=node),extendto = 11.5)
p <- p %<+% protein_metadata +
geom_tippoint(
aes(color = phylum),
size = 0.4,
show.legend = TRUE
) +
geom_tiplab(
aes(color = phylum,
size = font_size,
fontface = font_style),
align=TRUE,
linetype=3,
#size = 3,
hjust = -0.1,
linesize= 0.2,
show.legend=FALSE,
offset = 0.05
) +
scale_size_identity(guide = "none") +
scale_color_manual(
name = "Phylum",
values = phylum_palette,
na.translate = FALSE
)
p <- p +
geom_cladelab(
data = set_clades,
mapping = aes(
node = node,
label = name
# offset.text = offset.text,
),
align = FALSE,
offset = 7,
#offset.text = 0.24,
hjust = "left",
barsize = 1,
fontsize = 3,
#angle = "auto",
horizontal = FALSE
)
p <- p +
# geom_fruit(
#   data=lifestyle_metadata,
#   geom=geom_tile,
#   mapping=aes(
#     y=protein_id,
#     x=lifestyle,
#     alpha=binary,
#     fill = lifestyle_set,),
#   offset = 0.34,
#   # width = 0.1,
#   # height = 1,
#   axis.params = list(
#     axis = "x",  # Display the x-axis
#     text.size = 3, # Adjust tick label size
#     text.angle = 30, # Rotate tick labels for better readability
#     line.size = 0,
#     hjust = "right"
#   )
# ) +
# scale_fill_manual(
#   name = "Lifestyle",
#   values = unique(unname(lifestyle_palette))
# ) +
geom_treescale(fontsize=3, linesize=1, x=0.1, y=-0.05)
file_height <- 40
file_width <- 30
ggsave(output_tree_rect,
plot = p,
width = file_width,
height = file_height,
limitsize = FALSE)
# -----------------------------
# Build the final trees
# -----------------------------
# The rectangular layout tree.
p <- ggtree(tree,
size=0.15
) +
xlim(-0.1,NA) +
ylim(-0.1,NA) +
geom_nodelab(size = 2, nudge_x = 0.01, nudge_y = 0.5) +
geom_highlight(data = highlight_nodes,aes(node=node),extendto = 11.5)
p <- p %<+% protein_metadata +
geom_tippoint(
aes(color = phylum),
size = 0.4,
show.legend = TRUE
) +
geom_tiplab(
aes(color = phylum,
size = font_size,
fontface = font_style),
align=TRUE,
linetype=3,
#size = 3,
hjust = -0.1,
linesize= 0.2,
show.legend=FALSE,
offset = 0.05
) +
scale_size_identity(guide = "none") +
scale_color_manual(
name = "Phylum",
values = phylum_palette,
na.translate = FALSE
)
p <- p +
geom_cladelab(
data = set_clades,
mapping = aes(
node = node,
label = name
# offset.text = offset.text,
),
align = FALSE,
offset = 7,
#offset.text = 0.24,
hjust = "left",
barsize = 1,
fontsize = 3,
#angle = "auto",
horizontal = FALSE
)
p <- p +
# geom_fruit(
#   data=lifestyle_metadata,
#   geom=geom_tile,
#   mapping=aes(
#     y=protein_id,
#     x=lifestyle,
#     alpha=binary,
#     fill = lifestyle_set,),
#   offset = 0.34,
#   # width = 0.1,
#   # height = 1,
#   axis.params = list(
#     axis = "x",  # Display the x-axis
#     text.size = 3, # Adjust tick label size
#     text.angle = 30, # Rotate tick labels for better readability
#     line.size = 0,
#     hjust = "right"
#   )
# ) +
# scale_fill_manual(
#   name = "Lifestyle",
#   values = unique(unname(lifestyle_palette))
# ) +
geom_treescale(fontsize=3, linesize=1, x=0.1, y=-0.05)
file_height <- 40
file_width <- 30
ggsave(output_tree_rect,
plot = p,
width = file_width,
height = file_height,
limitsize = FALSE)
# -----------------------------
# Build the final tree
# -----------------------------
# The circular layout tree.
p <- ggtree(tree,
layout="fan",
size=0.15,
open.angle=10
) +
xlim(-0.1,NA) +
#ylim(-0.1,NA) +
geom_nodelab(size = 3, nudge_x = -0.1, nudge_y = -0.8) +
#geom_nodelab(aes(label = node),size = 3, nudge_x = 0.01, nudge_y = 0.5) +
geom_highlight(data = highlight_nodes,aes(node=node), extendto = 11.5)
p <- rotate_tree(p, -90)
p <- p %<+% protein_metadata +
geom_tippoint(
aes(color = phylum),
size = 0.4,
show.legend = TRUE
) +
geom_tiplab(
aes(color = phylum),
align=TRUE,
linetype=3,
size = 4,
hjust = -0.1,
linesize= 0.2,
show.legend=FALSE,
offset = 0.1
) +
scale_color_manual(
name = "Phylum",
values = phylum_palette,
na.translate = FALSE
)
p <- p +
geom_cladelab(
data = set_clades,
mapping = aes(
node = node,
label = name,
offset.text = offset.text,
),
align = TRUE,
offset = 1.2,
#offset.text = 0.24,
hjust = "center",
barsize = 1,
fontsize = 4,
angle = "auto",
horizontal = FALSE
)
p <- p +
# geom_fruit(
#   data=lifestyle_metadata,
#   geom=geom_tile,
#   mapping=aes(
#     y=protein_id,
#     x=lifestyle,
#     alpha=binary,
#     fill = lifestyle_set,),
#   offset = 0.4,
#   pwidth = 0.4,
#   # height = 1,
#   axis.params = list(
#     axis = "x",  # Display the x-axis
#     text.size = 3, # Adjust tick label size
#     #text.angle = 90, # Rotate tick labels for better readability
#     line.size = 0,
#     hjust = "right"
#   )
# ) +
# scale_fill_manual(
#   name = "Lifestyle",
#   values = unique(unname(lifestyle_palette))
# ) +
geom_treescale(fontsize=3, linesize=1, x=0.5, y=0.1)
file_height <- 50
file_width <- 50
ggsave(output_tree_circ,
plot = p,
width = file_width,
height = file_height,
limitsize = FALSE)
# -----------------------------
# Build the final tree
# -----------------------------
# The circular layout tree.
p <- ggtree(tree,
layout="fan",
size=0.15,
open.angle=10
) +
xlim(-0.1,NA) +
#ylim(-0.1,NA) +
geom_nodelab(size = 3, nudge_x = -0.1, nudge_y = -0.8) +
#geom_nodelab(aes(label = node),size = 3, nudge_x = 0.01, nudge_y = 0.5) +
geom_highlight(data = highlight_nodes,aes(node=node), extendto = 11.5)
# p <- rotate_tree(p, -90)
p <- p %<+% protein_metadata +
geom_tippoint(
aes(color = phylum),
size = 0.4,
show.legend = TRUE
) +
geom_tiplab(
aes(color = phylum, size = font_size+1, fontface = font_style),
align=TRUE,
linetype=3,
#size = 4,
hjust = -0.1,
linesize= 0.2,
show.legend=FALSE,
offset = 0.1
) +
scale_color_manual(
name = "Phylum",
values = phylum_palette,
na.translate = FALSE
)
p <- p +
geom_cladelab(
data = set_clades,
mapping = aes(
node = node,
label = name,
offset.text = offset.text,
),
align = TRUE,
offset = 1.2,
#offset.text = 0.24,
hjust = "center",
barsize = 1,
fontsize = 4,
angle = "auto",
horizontal = FALSE
)
p <- p +
# geom_fruit(
#   data=lifestyle_metadata,
#   geom=geom_tile,
#   mapping=aes(
#     y=protein_id,
#     x=lifestyle,
#     alpha=binary,
#     fill = lifestyle_set,),
#   offset = 0.4,
#   pwidth = 0.4,
#   # height = 1,
#   axis.params = list(
#     axis = "x",  # Display the x-axis
#     text.size = 3, # Adjust tick label size
#     #text.angle = 90, # Rotate tick labels for better readability
#     line.size = 0,
#     hjust = "right"
#   )
# ) +
# scale_fill_manual(
#   name = "Lifestyle",
#   values = unique(unname(lifestyle_palette))
# ) +
geom_treescale(fontsize=3, linesize=1, x=0.5, y=0.1)
file_height <- 50
file_width <- 50
ggsave(output_tree_circ,
plot = p,
width = file_width,
height = file_height,
limitsize = FALSE)
# -----------------------------
# Build the final tree
# -----------------------------
# The circular layout tree.
p <- ggtree(tree,
layout="fan",
size=0.15,
open.angle=10
) +
xlim(-0.1,NA) +
#ylim(-0.1,NA) +
geom_nodelab(size = 3, nudge_x = -0.1, nudge_y = -0.8) +
#geom_nodelab(aes(label = node),size = 3, nudge_x = 0.01, nudge_y = 0.5) +
geom_highlight(data = highlight_nodes,aes(node=node), extendto = 11.5)
# p <- rotate_tree(p, -90)
p <- p %<+% protein_metadata +
geom_tippoint(
aes(color = phylum),
size = 0.4,
show.legend = TRUE
) +
geom_tiplab(
aes(color = phylum, size = font_size+1, fontface = font_style),
align=TRUE,
linetype=3,
#size = 4,
hjust = -0.1,
linesize= 0.2,
show.legend=FALSE,
offset = 0.1
) +
scale_size_identity(guide = "none") +
scale_color_manual(
name = "Phylum",
values = phylum_palette,
na.translate = FALSE
)
p <- p +
geom_cladelab(
data = set_clades,
mapping = aes(
node = node,
label = name,
offset.text = offset.text,
),
align = TRUE,
offset = 1.2,
#offset.text = 0.24,
hjust = "center",
barsize = 1,
fontsize = 4,
angle = "auto",
horizontal = FALSE
)
p <- p +
# geom_fruit(
#   data=lifestyle_metadata,
#   geom=geom_tile,
#   mapping=aes(
#     y=protein_id,
#     x=lifestyle,
#     alpha=binary,
#     fill = lifestyle_set,),
#   offset = 0.4,
#   pwidth = 0.4,
#   # height = 1,
#   axis.params = list(
#     axis = "x",  # Display the x-axis
#     text.size = 3, # Adjust tick label size
#     #text.angle = 90, # Rotate tick labels for better readability
#     line.size = 0,
#     hjust = "right"
#   )
# ) +
# scale_fill_manual(
#   name = "Lifestyle",
#   values = unique(unname(lifestyle_palette))
# ) +
geom_treescale(fontsize=3, linesize=1, x=0.5, y=0.1)
file_height <- 50
file_width <- 50
ggsave(output_tree_circ,
plot = p,
width = file_width,
height = file_height,
limitsize = FALSE)
